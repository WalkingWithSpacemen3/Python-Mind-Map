(self["webpackChunkmindmap"]=self["webpackChunkmindmap"]||[]).push([[88],{88:function(s,t,e){"use strict";e.r(t),e.d(t,{default:function(){return p}});var i=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",[e("div",{staticClass:"title"},[e("div",[s._v("python第"+s._s(s.ChapterID)+"章")]),e("div",[s._v(s._s(s.TestName))])]),e("el-form",{staticClass:"main"},[e("P",{staticClass:"headline"},[s._v("客观题"),s.isSubmit?e("span",{staticClass:"score"},[s._v("正确率："+s._s(s.score))]):s._e()]),s._l(s.optQuesList,(function(t,i){return e("el-form-item",{attrs:{size:"medium"}},[e("P",{staticClass:"quesTitle",class:{wrongAns:!1===s.checkResult.optQuesRes[i]}},[e("span",{staticClass:"quesNum"},[s._v(s._s(t.number))]),s._v(s._s(t.title)+" "),!1===s.checkResult.optQuesRes[i]?e("i",{staticClass:"el-icon-close"}):s._e()]),e("el-radio-group",{model:{value:s.optAns[i],callback:function(t){s.$set(s.optAns,i,t)},expression:"optAns[i]"}},s._l(t.options,(function(t,i){return e("div",[e("el-radio",{attrs:{label:s.getAlpha(i),size:"medium"}},[e("span",[s._v(s._s(s.getAlpha(i))+".")]),e("span",{staticClass:"option"},[s._v(s._s(t))])])],1)})),0),s.isSubmit?e("div",{staticClass:"correctAnswer"},[s._v("正确答案："+s._s(s.correctAnswers[0][i]))]):s._e()],1)})),s._l(s.multiOptQuestList,(function(t,i){return e("el-form-item",{attrs:{size:"medium"}},[e("P",{staticClass:"quesTitle",class:{wrongAns:!1===s.checkResult.multiOptQuesRes[i]}},[e("span",{staticClass:"quesNum"},[s._v(s._s(t.number))]),s._v("（多选）"+s._s(t.title)+" "),!1===s.checkResult.multiOptQuesRes[i]?e("i",{staticClass:"el-icon-close"}):s._e()]),e("el-checkbox-group",{attrs:{size:"medium"},model:{value:s.multiAns[i],callback:function(t){s.$set(s.multiAns,i,t)},expression:"multiAns[i]"}},s._l(t.options,(function(t,i){return e("div",[e("el-checkbox",{attrs:{label:s.getAlpha(i),size:"medium"}},[e("span",[s._v(s._s(s.getAlpha(i))+".")]),e("span",{staticClass:"option"},[s._v(s._s(t))])])],1)})),0),s.isSubmit?e("div",{staticClass:"correctAnswer"},[s._v("正确答案："+s._s(s.correctAnswers[1][i]))]):s._e()],1)})),s._l(s.TFQuestionList,(function(t,i){return e("el-form-item",{attrs:{size:"medium"}},[e("P",{staticClass:"quesTitle",class:{wrongAns:!1===s.checkResult.TFQuesRes[i]}},[e("span",{staticClass:"quesNum"},[s._v(s._s(t.number))]),s._v(s._s(t.title)+" "),!1===s.checkResult.TFQuesRes[i]?e("i",{staticClass:"el-icon-close"}):s._e()]),e("el-radio-group",{model:{value:s.TFAns[i],callback:function(t){s.$set(s.TFAns,i,t)},expression:"TFAns[i]"}},[e("div",[e("el-radio",{attrs:{label:"1",size:"medium"}},[e("i",{staticClass:"el-icon-check TFOpt"})])],1),e("div",[e("el-radio",{attrs:{label:"0",size:"medium"}},[e("i",{staticClass:"el-icon-close TFOpt"})])],1)]),s.isSubmit?e("div",{staticClass:"correctAnswer"},[s._v("正确答案："+s._s(s.correctAnswers[2][i]))]):s._e()],1)})),s._l(s.blankQuesList,(function(t,i){return e("el-form-item",[e("P",{staticClass:"quesTitle",class:{wrongAns:!1===s.checkResult.blanQuesRes[i]}},[e("span",{staticClass:"quesNum"},[s._v(s._s(t.number))]),s._v(s._s(t.title)+" "),!1===s.checkResult.blanQuesRes[i]?e("i",{staticClass:"el-icon-close"}):s._e()]),e("el-input",{staticStyle:{width:"50%"},attrs:{size:"medium",clearable:""},model:{value:s.blanAns[i],callback:function(t){s.$set(s.blanAns,i,t)},expression:"blanAns[i]"}}),s.isSubmit?e("div",{staticClass:"correctAnswer"},[s._v("正确答案："+s._s(s.correctAnswers[3][i]))]):s._e()],1)})),e("el-button",{staticClass:"subBtn",attrs:{type:"primary"},on:{click:s.clickSubmit}},[s._v("提交答案")]),s.programQuestList.length>0?e("el-divider"):s._e(),s.programQuestList.length>0?e("P",{staticClass:"headline"},[s._v("编程题"),e("span",{staticStyle:{"font-size":"0.8em","font-weight":"normal"}},[s._v("（将代码文件上传即可）")])]):s._e(),s._l(s.programQuestList,(function(t,i){return e("el-form-item",[e("P",{staticClass:"quesTitle"},[e("span",{staticClass:"quesNum"},[s._v(s._s(t.number))]),s._v(s._s(t.title))]),e("el-upload",{staticClass:"upload-demo",attrs:{drag:"",limit:1,"file-list":s.codefileList[i],"show-file-list":"","auto-upload":!1,"on-error":s.uploadError,"on-success":s.uploadSuccess,action:"#","on-change":function(t,e){return s.handleChange(t,e,i)},"on-remove":function(t,e){return s.fileRemove(t,e,i)}}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[s._v("将文件拖到此处，或"),e("em",[s._v("点击上传")])])]),e("el-button",{staticClass:"subBtn",attrs:{type:"primary"},on:{click:function(){return s.upload(i)}}},[s._v("上传")])],1)}))],2),e("el-dialog",{attrs:{title:"提示",visible:s.dialogVisible,width:"20%",top:"35vh"},on:{"update:visible":function(t){s.dialogVisible=t}}},[e("span",[s._v("确定要提交答案？")]),s.isFinished?s._e():e("div",{staticClass:"unFinishWarn"},[e("i",{staticClass:"el-icon-warning"}),s._v("还有题目未完成")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"btn",on:{click:function(t){s.dialogVisible=!1}}},[s._v("取 消")]),e("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:s.submit}},[s._v("确 定")])],1)])],1)},l=[],n=(e(7658),e(7004));let o=e(6230);function a(s){return JSON.parse(JSON.stringify(s))}var r={name:"AnswerCar",data(){return{ChapterID:1,TestID:1,TestName:"",UserID:"",chapterName:"",isSubmit:!1,optQuesList:[],optQuestion:{number:0,title:"",options:[]},multiOptQuestList:[],TFQuestionList:[],blankQuesList:[],blankQuestion:{title:"",number:0},programQuestList:[],checkResult:{optQuesRes:[],multiOptQuesRes:[],TFQuesRes:[],blanQuesRes:[]},correctAnswers:[],optAns:[],multiAns:[[]],TFAns:[],blanAns:[],UserAnswers:[],dialogVisible:!1,isFinished:!1,score:"",codefileList:[]}},mounted(){this.UserID=this.$store.state.userInfo.userID,this.ChapterID=this.$route.query.ChapterID,this.TestID=this.$route.query.TestID,this.TestName=this.$route.query.TestName,this.optQuesList=[],this.multiOptQuestList=[],this.TFQuestionList=[],this.blankQuesList=[],this.programQuestList=[];let s=`/user/getquestions?ChapterID=${this.ChapterID}&TestID=${this.TestID}&UserID=${this.UserID}`;n.Z.get(s).then((s=>{if(200===s.status){this.optAns=[],this.multiAns=[],this.TFAns=[],this.blanAns=[];for(let t of s.data.data.questions){let s=t.Description.split("@");switch(t.QuestionType){case 0:this.optQuestion.title=s[0],this.optQuestion.options=s.slice(1),this.optQuestion.number=t.QuestionNumber,this.optQuesList.push(a(this.optQuestion)),this.optAns.push("");break;case 1:this.optQuestion.title=s[0],this.optQuestion.options=s.slice(1),this.optQuestion.number=t.QuestionNumber,this.multiOptQuestList.push(a(this.optQuestion)),this.multiAns.push([]);break;case 2:this.blankQuestion.title=s[0],this.blankQuestion.number=t.QuestionNumber,this.TFQuestionList.push(a(this.blankQuestion)),this.TFAns.push("");break;case 3:this.blankQuestion.title=s[0],this.blankQuestion.number=t.QuestionNumber,this.blankQuesList.push(a(this.blankQuestion)),this.blanAns.push("");break;case 4:this.blankQuestion.title=s[0],this.blankQuestion.number=t.QuestionNumber,this.programQuestList.push(a(this.blankQuestion)),this.codefileList.push([])}}!0===s.data.data.hasDoneTest&&this.showAns()}})).catch((s=>{console.log(s),this.$message({type:"error",message:"加载失败"})}))},methods:{clickSubmit(){this.UserAnswers=[];let s=0;for(let e of this.optAns)this.UserAnswers[s++]=void 0===e||""===e?"null":e;for(let e of this.multiAns)this.UserAnswers[s++]=void 0===e||e===[]?"null":e.sort().join("");for(let e of this.TFAns)this.UserAnswers[s++]=void 0===e||""===e?"null":e;for(let e of this.blanAns)this.UserAnswers[s++]=void 0===e||""===e?"null":e;console.log(this.UserAnswers),this.dialogVisible=!0;let t=0;for(let e of this.UserAnswers)"null"!==e&&t++;t===this.UserAnswers.length&&(this.isFinished=!0)},submit(){if(this.dialogVisible=!1,!0===this.isSubmit)return void this.$message({type:"warning",message:"已提交过答案，不能再次提交"});let s=this.UserAnswers.join("@"),t=new o;t.append("ChapterID",this.ChapterID),t.append("TestID",this.TestID),t.append("UserID",this.UserID),t.append("Answers",s),n.Z.post("/user/createanswersheet",t).then((s=>{200===s.status&&(this.$message({type:"success",message:"提交成功"}),this.showAns())})).catch((s=>{console.log(s),this.$message({type:"error",message:"提交失败"})}))},showAns(){let s=`/user/getcorrectanswers?ChapterID=${this.ChapterID}&TestID=${this.TestID}&UserID=${this.UserID}`;n.Z.get(s).then((s=>{if(200===s.status){let t=this.optQuesList.length,e=t+this.multiOptQuestList.length,i=e+this.TFQuestionList.length,l=i+this.blankQuesList.length,n=s.data.data["correct answer"].split("@");this.correctAnswers=[],this.correctAnswers.push(n.slice(0,t)),this.correctAnswers.push(n.slice(t,e)),this.correctAnswers.push(n.slice(e,i)),this.correctAnswers.push(n.slice(i,l));let o=s.data.data["result"];this.checkResult.optQuesRes=o.slice(0,t),this.checkResult.multiOptQuesRes=o.slice(t,e),this.checkResult.TFQuesRes=o.slice(e,i),this.checkResult.blanQuesRes=o.slice(i,l),this.UserAnswers=s.data.data["user answer"].split("@"),this.optAns=this.UserAnswers.slice(0,t),this.multiAns=[];for(let s of this.UserAnswers.slice(t,e)){let t=s.split("");this.multiAns.push(t)}this.TFAns=this.UserAnswers.slice(e,i),this.blanAns=this.UserAnswers.slice(i,l),this.score=0,o.forEach((s=>{!0===s&&this.score++})),this.score=this.score+" / "+o.length,this.isSubmit=!0}})).catch((s=>{console.log(s),this.$message({type:"error",message:"获取答题信息失败"})}))},onBeforeUpload(s){const t="image/jpeg"===s.type||"image/gif",e=s.size/1024/1024<1;return t||this.$message.error("上传文件只能是图片格式!"),e||this.$message.error("上传文件大小不能超过 1MB!"),t&&e},uploadError(s,t,e){console.log(s),console.log(e)},uploadSuccess(s,t,e){console.log(s),console.log(e)},handleChange(s,t,e){this.codefileList[e]=t,console.log(t)},fileRemove(s,t,e){console.log(t),this.codefileList[e]=t},upload(s){let t=new o;if(0===this.codefileList[s].length)return void this.$message({type:"error",message:"未提交文件"});let e=this.codefileList[s][0].raw;t.append("codes",e),console.log(e);let i=`/user/uploadcodes?ChapterID=${this.ChapterID}&TestID=${this.TestID}`;n.Z.post(i,t).then((s=>{200===s.status&&this.$message("上传成功")})).catch((s=>{console.log(s),this.$message({type:"error",message:"上传失败"})}))},getAlpha(s){return String.fromCharCode(65+s)}}},u=r,c=e(3736),h=(0,c.Z)(u,i,l,!1,null,"6c83c6ee",null),p=h.exports},6230:function(s){s.exports="object"==typeof self?self.FormData:window.FormData}}]);
//# sourceMappingURL=88.831af056.js.map