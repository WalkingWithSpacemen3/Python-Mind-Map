{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { copyRenderTree, simpleDeepClone } from 'simple-mind-map/src/utils';\n/** \r\n * @Author: 王林 \r\n * @Date: 2021-05-04 13:10:06 \r\n * @Desc: 命令类 \r\n */\n\nclass Command {\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-05-04 13:10:24 \r\n   * @Desc: 构造函数 \r\n   */\n  constructor(opt = {}) {\n    this.opt = opt;\n    this.mindMap = opt.mindMap;\n    this.commands = {};\n    this.history = [];\n    this.activeHistoryIndex = 0; // 注册快捷键\n\n    this.registerShortcutKeys();\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-08-03 23:06:55 \r\n   * @Desc: 清空历史数据 \r\n   */\n\n\n  clearHistory() {\n    this.history = [];\n    this.activeHistoryIndex = 0;\n    this.mindMap.emit('back_forward', 0, 0);\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-08-02 23:23:19 \r\n   * @Desc: 注册快捷键 \r\n   */\n\n\n  registerShortcutKeys() {\n    this.mindMap.keyCommand.addShortcut('Control+z', () => {\n      this.mindMap.execCommand('BACK');\n    });\n    this.mindMap.keyCommand.addShortcut('Control+y', () => {\n      this.mindMap.execCommand('FORWARD');\n    });\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-05-04 13:12:30 \r\n   * @Desc: 执行命令 \r\n   */\n\n\n  exec(name, ...args) {\n    if (this.commands[name]) {\n      this.commands[name].forEach(fn => {\n        fn(...args);\n      });\n\n      if (name === 'BACK' || name === 'FORWARD') {\n        return;\n      }\n\n      this.addHistory();\n    }\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-05-04 13:13:01 \r\n   * @Desc: 添加命令 \r\n   */\n\n\n  add(name, fn) {\n    if (this.commands[name]) {\n      this.commands[name].push(fn);\n    } else {\n      this.commands[name] = [fn];\n    }\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-07-15 23:02:41 \r\n   * @Desc: 移除命令 \r\n   */\n\n\n  remove(name, fn) {\n    if (!this.commands[name]) {\n      return;\n    }\n\n    if (!fn) {\n      this.commands[name] = [];\n      delete this.commands[name];\n    } else {\n      let index = this.commands[name].find(item => {\n        return item === fn;\n      });\n\n      if (index !== -1) {\n        this.commands[name].splice(index, 1);\n      }\n    }\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-05-04 14:35:43 \r\n   * @Desc: 添加回退数据 \r\n   */\n\n\n  addHistory() {\n    let data = this.getCopyData();\n    this.history.push(simpleDeepClone(data));\n    this.activeHistoryIndex = this.history.length - 1;\n    this.mindMap.emit('data_change', data);\n    this.mindMap.emit('back_forward', this.activeHistoryIndex, this.history.length);\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-07-11 22:34:53 \r\n   * @Desc: 回退 \r\n   */\n\n\n  back(step = 1) {\n    if (this.activeHistoryIndex - step >= 0) {\n      this.activeHistoryIndex -= step;\n      this.mindMap.emit('back_forward', this.activeHistoryIndex, this.history.length);\n      return simpleDeepClone(this.history[this.activeHistoryIndex]);\n    }\n  }\n  /** \r\n   * javascript comment \r\n   * @Author: 王林25 \r\n   * @Date: 2021-07-12 10:45:31 \r\n   * @Desc: 前进 \r\n   */\n\n\n  forward(step = 1) {\n    let len = this.history.length;\n\n    if (this.activeHistoryIndex + step <= len - 1) {\n      this.activeHistoryIndex += step;\n      this.mindMap.emit('back_forward', this.activeHistoryIndex);\n      return simpleDeepClone(this.history[this.activeHistoryIndex]);\n    }\n  }\n  /** \r\n   * @Author: 王林 \r\n   * @Date: 2021-05-04 15:02:58 \r\n   * @Desc: 获取渲染树数据副本 \r\n   */\n\n\n  getCopyData() {\n    return copyRenderTree({}, this.mindMap.renderer.renderTree);\n  }\n\n}\n\nexport default Command;","map":{"version":3,"names":["copyRenderTree","simpleDeepClone","Command","constructor","opt","mindMap","commands","history","activeHistoryIndex","registerShortcutKeys","clearHistory","emit","keyCommand","addShortcut","execCommand","exec","name","args","forEach","fn","addHistory","add","push","remove","index","find","item","splice","data","getCopyData","length","back","step","forward","len","renderer","renderTree"],"sources":["C:/Users/13007/Documents/GinTest/vue/node_modules/simple-mind-map/src/Command.js"],"sourcesContent":["import { copyRenderTree, simpleDeepClone } from 'simple-mind-map/src/utils';\r\n\r\n/** \r\n * @Author: 王林 \r\n * @Date: 2021-05-04 13:10:06 \r\n * @Desc: 命令类 \r\n */\r\nclass Command {\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-05-04 13:10:24 \r\n     * @Desc: 构造函数 \r\n     */\r\n    constructor(opt = {}) {\r\n        this.opt = opt\r\n        this.mindMap = opt.mindMap\r\n        this.commands = {}\r\n        this.history = []\r\n        this.activeHistoryIndex = 0\r\n        // 注册快捷键\r\n        this.registerShortcutKeys()\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-08-03 23:06:55 \r\n     * @Desc: 清空历史数据 \r\n     */\r\n    clearHistory() {\r\n        this.history = []\r\n        this.activeHistoryIndex = 0\r\n        this.mindMap.emit('back_forward', 0, 0)\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-08-02 23:23:19 \r\n     * @Desc: 注册快捷键 \r\n     */\r\n    registerShortcutKeys() {\r\n        this.mindMap.keyCommand.addShortcut('Control+z', () => {\r\n            this.mindMap.execCommand('BACK')\r\n        })\r\n        this.mindMap.keyCommand.addShortcut('Control+y', () => {\r\n            this.mindMap.execCommand('FORWARD')\r\n        })\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-05-04 13:12:30 \r\n     * @Desc: 执行命令 \r\n     */\r\n    exec(name, ...args) {\r\n        if (this.commands[name]) {\r\n            this.commands[name].forEach((fn) => {\r\n                fn(...args)\r\n            })\r\n            if (name === 'BACK' || name === 'FORWARD') {\r\n                return;\r\n            }\r\n            this.addHistory()\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-05-04 13:13:01 \r\n     * @Desc: 添加命令 \r\n     */\r\n    add(name, fn) {\r\n        if (this.commands[name]) {\r\n            this.commands[name].push(fn)\r\n        } else {\r\n            this.commands[name] = [fn]\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-07-15 23:02:41 \r\n     * @Desc: 移除命令 \r\n     */\r\n    remove(name, fn) {\r\n        if (!this.commands[name]) {\r\n            return\r\n        }\r\n        if (!fn) {\r\n            this.commands[name] = []\r\n            delete this.commands[name]\r\n        } else {\r\n            let index = this.commands[name].find((item) => {\r\n                return item === fn;\r\n            })\r\n            if (index !== -1) {\r\n                this.commands[name].splice(index, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-05-04 14:35:43 \r\n     * @Desc: 添加回退数据 \r\n     */\r\n    addHistory() {\r\n        let data = this.getCopyData()\r\n        this.history.push(simpleDeepClone(data))\r\n        this.activeHistoryIndex = this.history.length - 1\r\n        this.mindMap.emit('data_change', data)\r\n        this.mindMap.emit('back_forward', this.activeHistoryIndex, this.history.length)\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-07-11 22:34:53 \r\n     * @Desc: 回退 \r\n     */\r\n    back(step = 1) {\r\n        if (this.activeHistoryIndex - step >= 0) {\r\n            this.activeHistoryIndex -= step\r\n            this.mindMap.emit('back_forward', this.activeHistoryIndex, this.history.length)\r\n            return simpleDeepClone(this.history[this.activeHistoryIndex]);\r\n        }\r\n    }\r\n\r\n    /** \r\n     * javascript comment \r\n     * @Author: 王林25 \r\n     * @Date: 2021-07-12 10:45:31 \r\n     * @Desc: 前进 \r\n     */\r\n    forward(step = 1) {\r\n        let len = this.history.length\r\n        if (this.activeHistoryIndex + step <= len - 1) {\r\n            this.activeHistoryIndex += step\r\n            this.mindMap.emit('back_forward', this.activeHistoryIndex,)\r\n            return simpleDeepClone(this.history[this.activeHistoryIndex]);\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @Author: 王林 \r\n     * @Date: 2021-05-04 15:02:58 \r\n     * @Desc: 获取渲染树数据副本 \r\n     */\r\n    getCopyData() {\r\n        return copyRenderTree({}, this.mindMap.renderer.renderTree)\r\n    }\r\n}\r\n\r\nexport default Command"],"mappings":"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"},"metadata":{},"sourceType":"module"}