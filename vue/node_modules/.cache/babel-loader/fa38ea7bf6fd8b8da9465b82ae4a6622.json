{"ast":null,"code":"/** \n * javascript comment \n * @Author: 王林25 \n * @Date: 2021-04-07 14:45:24 \n * @Desc: 视图操作类 \n */\nclass View {\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-04-07 14:45:40 \n   * @Desc: 构造函数 \n   */\n  constructor(opt = {}) {\n    this.opt = opt;\n    this.mindMap = this.opt.mindMap;\n    this.scale = 1;\n    this.sx = 0;\n    this.sy = 0;\n    this.x = 0;\n    this.y = 0;\n    this.firstDrag = true;\n    this.setTransformData(this.mindMap.opt.viewData);\n    this.bind();\n  }\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-04-07 15:38:51 \n   * @Desc: 绑定 \n   */\n\n\n  bind() {\n    // 快捷键\n    this.mindMap.keyCommand.addShortcut('Control+=', () => {\n      this.enlarge();\n    });\n    this.mindMap.keyCommand.addShortcut('Control+-', () => {\n      this.narrow();\n    });\n    this.mindMap.keyCommand.addShortcut('Control+Enter', () => {\n      this.reset();\n    });\n    this.mindMap.svg.on('dblclick', () => {\n      this.reset();\n    }); // 拖动视图\n\n    this.mindMap.event.on('mousedown', () => {\n      this.sx = this.x;\n      this.sy = this.y;\n    });\n    this.mindMap.event.on('drag', (e, event) => {\n      if (e.ctrlKey) {\n        // 按住ctrl键拖动为多选\n        return;\n      }\n\n      if (this.firstDrag) {\n        this.firstDrag = false; // 清除激活节点\n\n        this.mindMap.execCommand('CLEAR_ACTIVE_NODE');\n      }\n\n      this.x = this.sx + event.mousemoveOffset.x;\n      this.y = this.sy + event.mousemoveOffset.y;\n      this.transform();\n    });\n    this.mindMap.event.on('mouseup', () => {\n      this.firstDrag = true;\n    }); // 放大缩小视图\n\n    this.mindMap.event.on('mousewheel', (e, dir) => {\n      // // 放大\n      if (dir === 'down') {\n        this.enlarge();\n      } else {\n        // 缩小\n        this.narrow();\n      }\n    });\n  }\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-11-22 18:30:24 \n   * @Desc: 获取当前变换状态数据 \n   */\n\n\n  getTransformData() {\n    return {\n      transform: this.mindMap.draw.transform(),\n      state: {\n        scale: this.scale,\n        x: this.x,\n        y: this.y,\n        sx: this.sx,\n        sy: this.sy\n      }\n    };\n  }\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-11-22 19:54:17 \n   * @Desc: 动态设置变换状态数据 \n   */\n\n\n  setTransformData(viewData) {\n    if (viewData) {\n      Object.keys(viewData.state).forEach(prop => {\n        this[prop] = viewData.state[prop];\n      });\n      this.mindMap.draw.transform({ ...viewData.transform\n      });\n      this.mindMap.emit('view_data_change', this.getTransformData());\n      this.mindMap.emit('scale', this.scale);\n    }\n  }\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-07-13 15:49:06 \n   * @Desc: 平移x方向 \n   */\n\n\n  translateX(step) {\n    this.x += step;\n    this.transform();\n  }\n  /** \n   * javascript comment \n   * @Author: 王林25 \n   * @Date: 2021-07-13 15:48:52 \n   * @Desc: 平移y方向 \n   */\n\n\n  translateY(step) {\n    this.y += step;\n    this.transform();\n  }\n  /** \n   * @Author: 王林 \n   * @Date: 2021-07-04 17:13:14 \n   * @Desc:  应用变换\n   */\n\n\n  transform() {\n    this.mindMap.draw.transform({\n      scale: this.scale,\n      // origin: 'center center',\n      translate: [this.x, this.y]\n    });\n    this.mindMap.emit('view_data_change', this.getTransformData());\n  }\n  /** \n   * @Author: 王林 \n   * @Date: 2021-07-11 17:41:35 \n   * @Desc: 恢复\n   */\n\n\n  reset() {\n    this.scale = 1;\n    this.x = 0;\n    this.y = 0;\n    this.transform();\n  }\n  /** \n   * @Author: 王林 \n   * @Date: 2021-07-04 17:10:34 \n   * @Desc: 缩小 \n   */\n\n\n  narrow() {\n    if (this.scale - this.mindMap.opt.scaleRatio > 0.1) {\n      this.scale -= this.mindMap.opt.scaleRatio;\n    } else {\n      this.scale = 0.1;\n    }\n\n    this.transform();\n    this.mindMap.emit('scale', this.scale);\n  }\n  /** \n   * @Author: 王林 \n   * @Date: 2021-07-04 17:10:41 \n   * @Desc: 放大 \n   */\n\n\n  enlarge() {\n    this.scale += this.mindMap.opt.scaleRatio;\n    this.transform();\n    this.mindMap.emit('scale', this.scale);\n  }\n\n}\n\nexport default View;","map":{"version":3,"names":["View","constructor","opt","mindMap","scale","sx","sy","x","y","firstDrag","setTransformData","viewData","bind","keyCommand","addShortcut","enlarge","narrow","reset","svg","on","event","e","ctrlKey","execCommand","mousemoveOffset","transform","dir","getTransformData","draw","state","Object","keys","forEach","prop","emit","translateX","step","translateY","translate","scaleRatio"],"sources":["D:/新建文件夹/git项目/GinTest-1/vue/node_modules/simple-mind-map/src/View.js"],"sourcesContent":["/** \n * javascript comment \n * @Author: 王林25 \n * @Date: 2021-04-07 14:45:24 \n * @Desc: 视图操作类 \n */\nclass View {\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-04-07 14:45:40 \n     * @Desc: 构造函数 \n     */\n    constructor(opt = {}) {\n        this.opt = opt\n        this.mindMap = this.opt.mindMap\n        this.scale = 1\n        this.sx = 0\n        this.sy = 0\n        this.x = 0\n        this.y = 0\n        this.firstDrag = true\n        this.setTransformData(this.mindMap.opt.viewData)\n        this.bind()\n    }\n\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-04-07 15:38:51 \n     * @Desc: 绑定 \n     */\n    bind() {\n        // 快捷键\n        this.mindMap.keyCommand.addShortcut('Control+=', () => {\n            this.enlarge()\n        })\n        this.mindMap.keyCommand.addShortcut('Control+-', () => {\n            this.narrow()\n        })\n        this.mindMap.keyCommand.addShortcut('Control+Enter', () => {\n            this.reset()\n        })\n        this.mindMap.svg.on('dblclick', () => {\n            this.reset()\n        })\n        // 拖动视图\n        this.mindMap.event.on('mousedown', () => {\n            this.sx = this.x\n            this.sy = this.y\n        })\n        this.mindMap.event.on('drag', (e, event) => {\n            if (e.ctrlKey) {\n                // 按住ctrl键拖动为多选\n                return\n            }\n            if (this.firstDrag) {\n                this.firstDrag = false\n                // 清除激活节点\n                this.mindMap.execCommand('CLEAR_ACTIVE_NODE')\n            }\n            this.x = this.sx + event.mousemoveOffset.x\n            this.y = this.sy + event.mousemoveOffset.y\n            this.transform()\n        })\n        this.mindMap.event.on('mouseup', () => {\n            this.firstDrag = true\n        })\n        // 放大缩小视图\n        this.mindMap.event.on('mousewheel', (e, dir) => {\n            // // 放大\n            if (dir === 'down') {\n                this.enlarge()\n            } else { // 缩小\n                this.narrow()\n            }\n        })\n    }\n\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-11-22 18:30:24 \n     * @Desc: 获取当前变换状态数据 \n     */\n    getTransformData() {\n        return {\n            transform: this.mindMap.draw.transform(),\n            state: {\n                scale: this.scale,\n                x: this.x,\n                y: this.y,\n                sx: this.sx,\n                sy: this.sy\n            }\n        }\n    }\n\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-11-22 19:54:17 \n     * @Desc: 动态设置变换状态数据 \n     */\n    setTransformData(viewData) {\n        if (viewData) {\n            Object.keys(viewData.state).forEach((prop) => {\n                this[prop] = viewData.state[prop]\n            })\n            this.mindMap.draw.transform({\n                ...viewData.transform\n            })\n            this.mindMap.emit('view_data_change', this.getTransformData())\n            this.mindMap.emit('scale', this.scale)\n        }\n    }\n\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-07-13 15:49:06 \n     * @Desc: 平移x方向 \n     */\n    translateX(step) {\n        this.x += step\n        this.transform()\n    }\n\n    /** \n     * javascript comment \n     * @Author: 王林25 \n     * @Date: 2021-07-13 15:48:52 \n     * @Desc: 平移y方向 \n     */\n    translateY(step) {\n        this.y += step\n        this.transform()\n    }\n\n    /** \n     * @Author: 王林 \n     * @Date: 2021-07-04 17:13:14 \n     * @Desc:  应用变换\n     */\n    transform() {\n        this.mindMap.draw.transform({\n            scale: this.scale,\n            // origin: 'center center',\n            translate: [this.x, this.y],\n        })\n        this.mindMap.emit('view_data_change', this.getTransformData())\n    }\n\n    /** \n     * @Author: 王林 \n     * @Date: 2021-07-11 17:41:35 \n     * @Desc: 恢复\n     */\n    reset() {\n        this.scale = 1\n        this.x = 0\n        this.y = 0\n        this.transform()\n    }\n\n    /** \n     * @Author: 王林 \n     * @Date: 2021-07-04 17:10:34 \n     * @Desc: 缩小 \n     */\n    narrow() {\n        if (this.scale - this.mindMap.opt.scaleRatio > 0.1) {\n            this.scale -= this.mindMap.opt.scaleRatio\n        } else {\n            this.scale = 0.1\n        }\n        this.transform()\n        this.mindMap.emit('scale', this.scale)\n    }\n\n    /** \n     * @Author: 王林 \n     * @Date: 2021-07-04 17:10:41 \n     * @Desc: 放大 \n     */\n    enlarge() {\n        this.scale += this.mindMap.opt.scaleRatio\n        this.transform()\n        this.mindMap.emit('scale', this.scale)\n    }\n}\n\nexport default View"],"mappings":"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"},"metadata":{},"sourceType":"module"}